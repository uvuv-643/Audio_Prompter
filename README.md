# Audio Prompter - Сервер-Клиент Система

Модульная система для автоматического создания скриншотов с централизованным управлением через сервер.

## Архитектура

### Сервер (server/)

- Центральный сервер управления на Ubuntu
- WebSocket соединения с клиентами
- Telegram бот для инициации команд
- Автоматический запуск через systemd

### Клиент (client/)

- Автономный режим (main.py) - локальный планировщик
- Клиент-серверный режим (client.py) - управление через сервер
- Поддержка множественных клиентов

## Быстрый старт

### 1. Развертывание сервера

```bash
# Скопируйте файлы сервера в нужную директорию и выполните:
./install.sh
```

### 2. Настройка Telegram Bot

```bash
# Отредактируйте .env файл
nano .env

# Добавьте ваш токен
TELEGRAM_BOT_TOKEN=your_bot_token_here

# Запустите сервер
source venv/bin/activate
python main.py
```

### 3. Запуск клиента

```bash
# Автономный режим
cd client
python main.py

# Клиент-серверный режим
cd client
python client.py --host SERVER_IP --port 8765
```

## Установка

### Сервер

```bash
cd server
pip install -r requirements.txt
python server.py
```

### Клиент

```bash
cd client
pip install -r requirements.txt
```

## Управление сервером

```bash
# Запуск
source venv/bin/activate
python main.py

# Логи
tail -f screenshot_server.log

# Остановка
Ctrl+C
```

## Функциональность

- Клик мыши в текущей позиции курсора
- Захват области 100x40 пикселей
- OCR распознавание тайминга (HH:MM:SS)
- Сохранение скриншотов с таймстемпом
- Управление через Telegram бот
- Поддержка множественных клиентов
- Автоматическое переподключение клиентов

## Протокол связи

WebSocket JSON сообщения:

### Сервер → Клиент

- `connection_established` - подтверждение подключения
- `execute_screenshot` - команда выполнить скриншот
- `heartbeat_ack` - подтверждение heartbeat

### Клиент → Сервер

- `screenshot_completed` - результат выполнения
- `screenshot_error` - ошибка выполнения
- `heartbeat` - проверка соединения

## Масштабирование

- Сервер поддерживает неограниченное количество клиентов
- Каждый клиент получает команды одновременно
- Автоматическое восстановление соединений
- Логирование всех операций

## Структура проекта

```
Audio_Prompter/
├── server/                 # Серверная часть
│   ├── main.py            # Точка входа сервера
│   ├── server.py          # Основной сервер
│   ├── telegram_bot.py    # Telegram бот
│   ├── install.sh         # Скрипт установки
│   └── requirements.txt   # Зависимости сервера
├── client/                # Клиентская часть
│   ├── main.py           # Автономный режим
│   ├── client.py         # Клиент-серверный режим
│   ├── screenshot_workflow.py # Логика скриншотов
│   └── requirements.txt  # Зависимости клиента
└── README.md             # Основная документация
```
